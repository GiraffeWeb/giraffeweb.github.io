#!/bin/bash

# Определяем пользователей
users=("gromov" "kuznetsov" "ryabov" "chistyakov" "yuvchenko" "ivanov")

# Определяем каталоги
directories=(
    "Экономика/Канцелярские_товары_НС"
    "Экономика/Продажи_ДСП"
    "Приказы_и_распоряжения"
    "База_данных"
    "Проекты/Горизонт-2030/Графические_документы/Несекретно"
    "Проекты/Горизонт-2030/Графические_документы/ДСП"
    "Проекты/Горизонт-2030/Графические_документы/Секретно"
    "Проекты/Горизонт-2030/Текстовые_документы/Несекретно"
    "Проекты/Горизонт-2030/Текстовые_документы/ДСП"
    "Проекты/Горизонт-2030/Текстовые_документы/Секретно"
    "Проекты/Горизонт-2030/Черновики/Громов"
    "Проекты/Горизонт-2030/Черновики/Кузнецов"
    "Проекты/Горизонт-2030/Черновики/Рябов"
)

# Матрица прав (П - полный доступ, Ч - только чтение, " " - запрет доступа)
permissions=(
    "r-- r-- r-- --- r-- ---"  # Экономика/Канцелярские_товары_НС
    "r-- r-- r-- --- r-- ---"  # Экономика/Продажи_ДСП
    "rw- --- --- rw- --- rw-"  # Приказы_и_распоряжения
    "rw- rw- rw- --- --- ---"  # База_данных
    "r-- r-- r-- --- --- r--"  # Проекты/Горизонт-2030/Графические_документы/Несекретно
    "rw- --- --- --- --- ---"  # Проекты/Горизонт-2030/Графические_документы/ДСП
    "--- --- --- --- --- rw-"  # Проекты/Горизонт-2030/Графические_документы/Секретно
    "rw- --- rw- r-- --- rw-"  # Проекты/Горизонт-2030/Текстовые_документы/Несекретно
    "--- rw- --- rw- --- rw-"  # Проекты/Горизонт-2030/Текстовые_документы/ДСП
    "--- --- --- --- --- rw-"  # Проекты/Горизонт-2030/Текстовые_документы/Секретно
    "rw- --- --- --- --- rw-"  # Проекты/Горизонт-2030/Черновики/Громов
    "--- rw- --- --- --- rw-"  # Проекты/Горизонт-2030/Черновики/Кузнецов
    "--- --- rw- --- --- rw-"  # Проекты/Горизонт-2030/Черновики/Рябов
)

# Применяем права к директориям
for i in "${!directories[@]}"; do
    dir="${directories[$i]}"
    perm="${permissions[$i]}"

    for j in "${!users[@]}"; do
        user="${users[$j]}"
        user_perm="${perm:$((j*3)):3}"

        if [[ "$user_perm" == "rw-" ]]; then
            sudo setfacl -m u:$user:rwx $dir
        elif [[ "$user_perm" == "r--" ]]; then
            sudo setfacl -m u:$user:rx $dir
        else
            sudo setfacl -x u:$user $dir
        fi
    done
done
